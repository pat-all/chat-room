(this["webpackJsonpweb-client"]=this["webpackJsonpweb-client"]||[]).push([[0],{24:function(e,a,t){e.exports=t(36)},29:function(e,a,t){},36:function(e,a,t){"use strict";t.r(a);var n=t(0),l=t.n(n),r=t(20),c=t.n(r),s=(t(29),t(8)),i=t(9),m=(t(30),t(3)),u=t.n(m),o=t(7),d=t(12),E=t(21),p=t(2),g=function(){var e=Object(n.useState)(!1),a=Object(p.a)(e,2),t=a[0],l=a[1],r=Object(n.useState)(null),c=Object(p.a)(r,2),s=c[0],i=c[1];return{request:Object(n.useCallback)(function(){var e=Object(o.a)(u.a.mark((function e(a){var t,n,r,c,s,m=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.length>1&&void 0!==m[1]?m[1]:"GET",n=m.length>2&&void 0!==m[2]?m[2]:null,r=m.length>3&&void 0!==m[3]?m[3]:{"Content-type":"application/json"},l(!0),e.prev=4,n&&(n=JSON.stringify(n)),e.next=8,fetch(a,{method:t,body:n,headers:r});case 8:return c=e.sent,e.next=11,c.json();case 11:if(s=e.sent,c.ok){e.next=14;break}throw new Error(s.message||"Something went wrong");case 14:return l(!1),e.abrupt("return",s);case 18:throw e.prev=18,e.t0=e.catch(4),l(!1),i(e.t0.message),e.t0;case 23:case"end":return e.stop()}}),e,null,[[4,18]])})));return function(a){return e.apply(this,arguments)}}(),[]),isFetching:t,error:s,clearError:Object(n.useCallback)((function(){i(null)}),[])}},b=function(){return Object(n.useCallback)((function(e){window.M&&e&&window.M.toast({html:e})}),[])},f=Object(n.createContext)({token:null,user:null,login:function(){},logout:function(){},isAuth:!1}),v=function(e){var a=e.form,t=e.changeFormHandler,n=e.submitHandler,r=e.isRegChecked,c=e.isRegCheckedHandler,s=e.isFetching;return l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col s6 offset-s3"},l.a.createElement("div",{className:"card blue-grey darken-1"},l.a.createElement("div",{className:"card-content white-text"},l.a.createElement("span",{className:"card-title"},"Authorization"),l.a.createElement("div",null,l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"input-field col s12"},l.a.createElement("input",{id:"email",type:"email",className:"validate",name:"email",onChange:t,value:a.email}),l.a.createElement("label",{htmlFor:"email"},"Email"))),r&&l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"input-field col s12"},l.a.createElement("input",{id:"username",type:"text",className:"validate",name:"username",onChange:t,value:a.username}),l.a.createElement("label",{htmlFor:"username"},"User name"))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"input-field col s12"},l.a.createElement("input",{id:"password",type:"password",className:"validate",name:"password",onChange:t,value:a.password}),l.a.createElement("label",{htmlFor:"password"},"Password"))),r&&l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"input-field col s12"},l.a.createElement("input",{id:"confirmpassword",type:"password",className:"validate",name:"confirmpassword",onChange:t,value:a.confirmpassword}),l.a.createElement("label",{htmlFor:"confirmpassword"},"Confirm password"))))),l.a.createElement("div",{className:"card-action"},l.a.createElement("button",{className:"btn waves-effect waves-light",type:"submit",name:"registration",onClick:n},"Submit"),l.a.createElement("label",{style:{marginLeft:20}},l.a.createElement("input",{type:"checkbox",className:"filled-in",defaultChecked:r,onClick:c,disabled:s}),l.a.createElement("span",null,"Registration"))))))},h=function(e){var a=e.logoutHandler,t=e.user;return l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col s6 offset-s3"},l.a.createElement("div",{className:"card blue-grey darken-1"},l.a.createElement("div",{className:"card-content white-text"},l.a.createElement("span",{className:"card-title"},"User"),l.a.createElement("p",null,"username: ",t&&t.username),l.a.createElement("p",null,"email: ",t&&t.email),l.a.createElement("br",null),l.a.createElement("p",null,"Your messages ids:"),t&&t.messages.map((function(e,a){return l.a.createElement("div",{key:e},l.a.createElement(s.b,{to:"/messages"},e))}))),l.a.createElement("div",{className:"card-action"},l.a.createElement("button",{className:"btn waves-effect waves-light",onClick:a},"Logout")))))},w=function(){var e=Object(n.useContext)(f),a=e.isAuth,t=e.logout,r=e.login,c=e.user,s=Object(n.useState)(null),i=Object(p.a)(s,2),m=i[0],w=i[1],N=b(),O=g(),j=O.isFetching,k=O.request,x=O.error,y=O.clearError,C=Object(n.useState)(!1),S=Object(p.a)(C,2),H=S[0],T=S[1],F=Object(n.useState)({email:"",password:"",confirmpassword:"",username:""}),q=Object(p.a)(F,2),D=q[0],L=q[1];Object(n.useEffect)((function(){N(x),y()}),[x,N,y]),Object(n.useEffect)((function(){N(m),w(null)}),[N,m,w]);var P=function(){var e=Object(o.a)(u.a.mark((function e(){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k("/api/auth/".concat(H?"register":"login"),"POST",D);case 3:a=e.sent,r(a.data.token,a.data.user),w(a.message),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return l.a.createElement(l.a.Fragment,null,a?l.a.createElement(h,{logoutHandler:t,user:c}):l.a.createElement(v,{form:D,isFetching:j,changeFormHandler:function(e){L(Object(E.a)({},D,Object(d.a)({},e.target.name,e.target.value)))},isRegCheckedHandler:function(){T(!H)},submitHandler:P}))},N=function(){var e={color:"#b71c1c"};return l.a.createElement("div",{className:"container"},l.a.createElement("h3",null,"Documentation"),l.a.createElement("a",{href:"https://github.com/pat-all/chat-room"},"Project on github"),l.a.createElement("p",null,"This is chat room restful api demonstration web-app"),l.a.createElement("h5",null,"Auth API"),l.a.createElement("p",null,l.a.createElement("blockquote",null,"POST: /api/auth/register"),"creates new user in databse, required parameters:",l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("b",null,"username")," - name of a user"),l.a.createElement("li",null,l.a.createElement("b",null,"email")," - user email"),l.a.createElement("li",null,l.a.createElement("b",null,"password")," - user password"),l.a.createElement("li",null,l.a.createElement("b",null,"confirmpassword")," - confirm user password"))),l.a.createElement("p",null,l.a.createElement("blockquote",null,"POST: /api/auth/login"),"authancicates user, and returns him a ",l.a.createElement("i",null,"token"),","," ",l.a.createElement("span",{style:e},"whitch is not used in this web-app"),", required parameters:",l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("b",null,"username")," - name of a user"),l.a.createElement("li",null,l.a.createElement("b",null,"email")," - user email"),l.a.createElement("li",null,l.a.createElement("b",null,"password")," - user password"),l.a.createElement("li",null,l.a.createElement("b",null,"confirmpassword")," - confirm user password"))),l.a.createElement("h5",null,"Messages API:"),l.a.createElement("p",null,l.a.createElement("blockquote",null,"GET: /api/messages/list/:num"),"get 10 messages from database, ",l.a.createElement("b",null,":num")," is a number of page starting from 0"),l.a.createElement("p",null,l.a.createElement("blockquote",null,"GET: /api/messages/single/:id"),"get single message from database, ",l.a.createElement("b",null,":id")," is a ",l.a.createElement("i",null,"ObjectId")," of message in a database"),l.a.createElement("p",null,l.a.createElement("blockquote",null,"POST: /api/messages/single"),"create new message in a database, required parameters:",l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("b",null,"author")," - ",l.a.createElement("i",null,"user name"),", if authenticated, or"," ",l.a.createElement("i",null,"unauthenticated")),l.a.createElement("li",null,l.a.createElement("b",null,"email")," - ",l.a.createElement("i",null,"user email"),", if authenticated, or ",l.a.createElement("i",null,"null")," ","if unauthenticated"),l.a.createElement("li",null,l.a.createElement("b",null,"text")," - entire text from 1 to 99 chars (min 1 non ",l.a.createElement("i",null,"space")," ","char)"),l.a.createElement("li",null,l.a.createElement("b",null,"created")," - ",l.a.createElement("i",null,"Date")," of message creation (",l.a.createElement("i",null,"automatically"),")"),l.a.createElement("li",null,l.a.createElement("b",null,"updated")," - ",l.a.createElement("i",null,"Date")," of message creation (",l.a.createElement("i",null,"automatically"),")"))),l.a.createElement("p",null,l.a.createElement("blockquote",null,"PUT: /api/messages/single -"," ",l.a.createElement("span",{style:e},"is not implemented in this web-app(!)")),"updates existing message, required parameters:",l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("b",null,"id")," - is a ",l.a.createElement("i",null,"ObjectId")," of message"),l.a.createElement("li",null,l.a.createElement("b",null,"text")," - entire text from 1 to 99 chars (min 1 non ",l.a.createElement("i",null,"space")," ","char)"),l.a.createElement("li",null,l.a.createElement("b",null,"updated")," - ",l.a.createElement("i",null,"Date")," of message updating (",l.a.createElement("i",null,"automatically"),")"))),l.a.createElement("p",null,l.a.createElement("blockquote",null,"DELETE: /api/messages/single"),"removes existing message from database, required parameters:",l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("b",null,"id")," - is a ",l.a.createElement("i",null,"ObjectId")," of message"))))},O=t(13),j={marginRight:10,color:"#1b5e20"},k={display:"flex",flexDirection:"row"},x=function(e){var a=e.messages,t=e.deleteMessageHandler;return l.a.createElement("ul",{className:"collection with-header"},l.a.createElement("li",{className:"collection-header"},l.a.createElement("h5",null,"Messages",a&&a.length>0&&": ".concat(a.length))),a&&a.length>0?a.map((function(e){return l.a.createElement("li",{className:"collection-item",key:e._id},l.a.createElement("div",{style:k},l.a.createElement("div",{className:"col m8 s8"},l.a.createElement("div",null,l.a.createElement("span",{style:j},"id:"),e._id),l.a.createElement("div",null,l.a.createElement("span",{style:j},"author:"),e.author),l.a.createElement("div",null,l.a.createElement("span",{style:j},"text:"),e.text),l.a.createElement("div",null,l.a.createElement("span",{style:j},"created:"),e.created),l.a.createElement("div",null,l.a.createElement("span",{style:j},"updated:"),e.updated)),l.a.createElement("div",{className:"col m4 s4"},l.a.createElement("div",{className:"row"},l.a.createElement("button",{style:{marginLeft:10},className:"btn waves-effect waves-light red accent-4",onClick:function(){return t(e._id)}},"Delete")))))})):l.a.createElement("li",{className:"collection-item"},"List is empty"))},y=function(e){var a=e.changeTextmHandler,t=e.text,r=e.sendHandler,c=e.isFetching,s=e.getListHandler,i=e.getSingleHandler,m=Object(n.useState)(""),u=Object(p.a)(m,2),o=u[0],d=u[1],E=Object(n.useState)(""),g=Object(p.a)(E,2),b=g[0],f=g[1];return l.a.createElement("div",{className:"card blue-grey darken-1"},l.a.createElement("div",{className:"card-content white-text"},l.a.createElement("span",{className:"card-title"},"Create message"),l.a.createElement("textarea",{placeholder:"max 99 chars",onChange:a,value:t.text})),l.a.createElement("div",{className:"card-action"},l.a.createElement("button",{className:"btn waves-effect waves-light",onClick:r,disabled:c},"Create")),l.a.createElement("div",{className:"card-action"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col s12"},"GET: /api/messages/list/:",l.a.createElement("div",{className:"input-field inline"},l.a.createElement("input",{id:"listNum",type:"text",value:o,onChange:function(e){d(e.target.value)}}),l.a.createElement("label",{htmlFor:"listNum"},"num")),l.a.createElement("button",{style:{marginLeft:10},className:"btn waves-effect waves-light",disabled:c,onClick:function(){s(o),d("")}},"Get List"))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col s12"},"GET: /api/messages/single/:",l.a.createElement("div",{className:"input-field inline"},l.a.createElement("input",{id:"singleMess",type:"text",value:b,onChange:function(e){f(e.target.value)}}),l.a.createElement("label",{htmlFor:"singleMess"},"id")),l.a.createElement("button",{style:{marginLeft:10},className:"btn waves-effect waves-light",onClick:function(){i(b),f("")},disabled:c},"Get Single")))))},C=function(){var e=Object(n.useContext)(f).user,a=b(),t=g(),r=t.isFetching,c=t.request,s=t.error,i=t.clearError,m=Object(n.useState)(null),d=Object(p.a)(m,2),E=d[0],v=d[1],h=Object(n.useState)([]),w=Object(p.a)(h,2),N=w[0],j=w[1],k=Object(n.useState)({text:""}),C=Object(p.a)(k,2),S=C[0],H=C[1];Object(n.useEffect)((function(){a(s),i()}),[s,a,i]),Object(n.useEffect)((function(){a(E),v(null)}),[a,E,v]);var T=function(){var a=Object(o.a)(u.a.mark((function a(){var t;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,c("/api/messages/single","POST",{text:S,email:e?e.email:""});case 3:t=a.sent,v(t.message),j([].concat(Object(O.a)(N),[t.data])),H({text:""}),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(0),console.log(a.t0.message);case 12:case"end":return a.stop()}}),a,null,[[0,9]])})));return function(){return a.apply(this,arguments)}}(),F=function(){var e=Object(o.a)(u.a.mark((function e(a){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("get list"),e.prev=1,e.next=4,c("/api/messages/list/".concat(a),"GET");case 4:t=e.sent,v(t.message),j(Object(O.a)(t.data)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(a){return e.apply(this,arguments)}}(),q=function(){var e=Object(o.a)(u.a.mark((function e(a){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c("/api/messages/single/".concat(a),"GET");case 3:t=e.sent,v(t.message),j([t.data]),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(a){return e.apply(this,arguments)}}(),D=function(){var e=Object(o.a)(u.a.mark((function e(a){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c("/api/messages/single","DELETE",{id:a});case 3:t=e.sent,v(t.message),j(Object(O.a)(N.filter((function(e){return e._id!==a})))),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(a){return e.apply(this,arguments)}}();return l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col s6 m6"},l.a.createElement(x,{messages:N,deleteMessageHandler:D})),l.a.createElement("div",{className:"col s6 m6"},l.a.createElement(y,{changeTextmHandler:function(e){H(e.target.value)},text:S,sendHandler:T,isFetching:r,getListHandler:F,getSingleHandler:q})))},S=function(){return l.a.createElement("nav",{className:"blue-grey"},l.a.createElement("div",{className:"nav-wrapper"},l.a.createElement(s.b,{to:"/",className:"brand-logo"},"Chat Room"),l.a.createElement("ul",{id:"nav-mobile",className:"right hide-on-med-and-down"},l.a.createElement("li",null,l.a.createElement(s.b,{to:"/authorization"},"Authorization")),l.a.createElement("li",null,l.a.createElement(s.b,{to:"/messages"},"Messages")),l.a.createElement("li",null,l.a.createElement(s.b,{to:"/"},"Documentation")))))},H=function(){var e=Object(n.useState)(null),a=Object(p.a)(e,2),t=a[0],l=a[1],r=Object(n.useState)(null),c=Object(p.a)(r,2),s=c[0],i=c[1],m=Object(n.useCallback)((function(e,a){l(e),i(a),localStorage.setItem("userData",JSON.stringify({token:e,user:a}))}),[]),u=Object(n.useCallback)((function(){l(null),i(null),localStorage.removeItem("userData")}),[]);return Object(n.useEffect)((function(){var e=JSON.parse(localStorage.getItem("userData"));e&&e.token&&m(e.token,e.user)}),[m]),{token:t,user:s,login:m,logout:u}};var T=function(){var e=H(),a=e.token,t=e.user,n=e.login,r=e.logout,c=!!a;return l.a.createElement(f.Provider,{value:{token:a,user:t,login:n,logout:r,isAuth:c}},l.a.createElement(s.a,null,l.a.createElement(S,null),l.a.createElement(i.c,null,l.a.createElement(i.a,{path:"/authorization"},l.a.createElement(w,null)),l.a.createElement(i.a,{path:"/messages"},l.a.createElement(C,null)),l.a.createElement(i.a,{path:"/",exact:!0},l.a.createElement(N,null)))))};c.a.render(l.a.createElement(T,null),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.d7cb09ad.chunk.js.map